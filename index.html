<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Le Maillon Faible - Banque & Minuteurs</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #0c1c2c;
      color: white;
      padding: 30px;
      margin: 0;
    }

    h1 {
      text-align: center;
      margin-bottom: 30px;
    }

    .display {
      font-size: 1.3rem;
      margin: 15px 0;
      text-align: center;
    }

    button {
      font-size: 1.1rem;
      padding: 10px 20px;
      margin: 8px;
      border-radius: 10px;
      border: none;
      cursor: pointer;
      transition: 0.2s;
    }

    .good { background-color: #28a745; color: white; }
    .bad { background-color: #dc3545; color: white; }
    .bank { background-color: #ffc107; color: black; }

    .controls {
      text-align: center;
      margin-bottom: 30px;
    }

    .layout {
      display: flex;
      justify-content: center;
      align-items: flex-start;
      gap: 60px;
      flex-wrap: wrap;
    }

    .echelle {
      width: 220px;
      text-align: left;
    }

    .montant {
      padding: 6px 12px;
      border-radius: 5px;
      margin: 4px 0;
      font-weight: bold;
    }

    .actuel {
      background-color: #28a745;
      color: white;
    }

    .inactif {
      color: gray;
    }

    #timersContainer {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 15px;
    }

    .timerBox {
      background-color: #1a2a3a;
      padding: 12px;
      border-radius: 10px;
      width: 180px;
      text-align: center;
    }

    .timerBox button {
      width: 100%;
    }

    .timerDisplay {
      margin-top: 12px;
      font-size: 2.4rem;
      font-weight: bold;
      color: #00ffcc;
    }

    .clignote {
      color: red !important;
      animation: clignote 1s step-start 0s infinite;
    }

    @keyframes clignote {
      50% { opacity: 0; }
      100% { opacity: 1; }
    }

    @media (max-width: 700px) {
      .layout {
        flex-direction: column;
        align-items: center;
      }

      #timersContainer {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <h1>üí° Le Maillon Faible - Banque & Minuteurs</h1>

  <div class="display">Gain en cours : <span id="currentGain">0</span> ‚Ç¨</div>
  <div class="display">Cagnotte totale : <span id="totalBanked">0</span> ‚Ç¨</div>

  <div class="controls">
    <button class="good" onclick="bonneReponse()">‚úÖ Bonne r√©ponse</button>
    <button class="bad" onclick="mauvaiseReponse()">‚ùå Mauvaise r√©ponse</button>
    <button class="bank" onclick="banquer()">üí∞ Banquer</button>
  </div>

  <div class="layout">
    <div class="echelle" id="echelle"></div>
    <div id="timersContainer"></div>
  </div>

  <script>
    // -------- BANQUE --------
    const montants = [0, 50, 100, 200, 300, 400, 1000, 2000, 3000, 4000, 5000];
    let niveauActuel = 0;
    let gainEnCours = montants[niveauActuel];
    let cagnotteTotale = 0;

    function updateAffichage() {
      gainEnCours = montants[niveauActuel];
      document.getElementById("currentGain").textContent = gainEnCours;
      document.getElementById("totalBanked").textContent = cagnotteTotale;
      updateEchelle();
    }

    function updateEchelle() {
      const container = document.getElementById("echelle");
      container.innerHTML = "";
      for (let i = montants.length - 1; i >= 0; i--) {
        const montant = montants[i];
        const div = document.createElement("div");
        div.className = "montant";
        if (i === niveauActuel) {
          div.classList.add("actuel");
        } else {
          div.classList.add("inactif");
        }
        div.textContent = montant + " ‚Ç¨";
        container.appendChild(div);
      }
    }

    function bonneReponse() {
      if (niveauActuel + 1 < montants.length) {
        niveauActuel++;
      }
      updateAffichage();
    }

    function mauvaiseReponse() {
      niveauActuel = 0;
      updateAffichage();
    }

    function banquer() {
      if (gainEnCours > 0) {
        cagnotteTotale += gainEnCours;
        niveauActuel = 0;
        updateAffichage();
      }
    }

    updateAffichage();

    // -------- MINUTEURS --------
    const durees = [150, 135, 120, 105, 90, 75, 60]; // secondes
    const timers = [];

    function formatTemps(s) {
      const min = Math.floor(s / 60);
      const sec = s % 60;
      return `${min}:${sec.toString().padStart(2, '0')}`;
    }

    function demarrerTimer(index) {
      if (timers[index] && timers[index].interval) {
        clearInterval(timers[index].interval);
      }

      let tempsRestant = durees[index];
      const display = document.getElementById(`timer${index}`);
      display.textContent = formatTemps(tempsRestant);

      timers[index] = {
        interval: setInterval(() => {
          tempsRestant--;
          if (tempsRestant <= 0) {
            clearInterval(timers[index].interval);
            display.textContent = "‚è∞ Temps √©coul√©";
            display.classList.remove("clignote");
          } else {
            display.textContent = formatTemps(tempsRestant);
            if (tempsRestant <= 10) {
              display.classList.add("clignote");
            } else {
              display.classList.remove("clignote");
            }
          }
        }, 1000)
      };
    }

    const container = document.getElementById("timersContainer");
    for (let i = 0; i < 7; i++) {
      const box = document.createElement("div");
      box.className = "timerBox";

      const btn = document.createElement("button");
      btn.textContent = `‚ñ∂Ô∏è Manche ${i + 1}`;
      btn.onclick = () => demarrerTimer(i);

      const timerDiv = document.createElement("div");
      timerDiv.id = `timer${i}`;
      timerDiv.className = "timerDisplay";
      timerDiv.textContent = formatTemps(durees[i]);

      box.appendChild(btn);
      box.appendChild(timerDiv);
      container.appendChild(box);
    }
  </script>
</body>
</html>
